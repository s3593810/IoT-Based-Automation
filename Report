import csv
import sqlite3 as lite
from glob import glob
from os.path import expanduser
from SenseHatDB import SensehatDB

class Report:
    def Rep(self):
        filename=input("Enter your Report Name: ")+(".csv")
        connection = lite.connect('sensehat.db')
        with connection:
            point = connection.cursor()
            
            for row in point.execute("SELECT * FROM SENSEHAT_data"):
                with open(filename, "w", newline='') as csv_file:  # Python 3 version    
                    csv_writer = csv.writer(csv_file)
                    csv_writer.writerow([i[0] for i in point.description]) # write headers
                    csv_writer.writerows(point)
